{
    "dataset": {
        "img_after_resize": [
            260,
            311,
            260
        ],
        "max_num_for_loading": [
            1000,
            3,
            5,
            1
        ],
        "normalize_via_range_clip": [0,2000],
        "seg": {
            "interested_label_list": [
                -1
            ],
            "num_crop_per_class_per_train_img": -1,
            "partition": {
                "mode": "pred",
                "overlap_size": [
                    16,
                    16,
                    16
                ],
                "padding_mode": "reflect"
            },
            "patch_size": [
                72,
                72,
                72
            ],
            "transform": {
                "my_bal_rand_crop": {
                    "bg_th_ratio": 0.5,
                    "scale_ratio": 0.1
                },
                "transform_seq": [
                    "my_balanced_random_crop"
                ]
            },
            "use_whole_img_as_input": false
        },
        "spacing_to_refer": [
            1.0,
            1.0,
            1.0
        ],
        "task_type": "seg"
    },
    "tsk_set": {
        "batch_sz": [
            6,
            1,
            1,
            1
        ],
        "check_best_model_period": 5,
        "continue_train": true,
        "continue_train_lr": 0.0005,
        "reset_train_epoch": true,
        "criticUpdates": 2,
        "epoch": 400,
        "gpu_ids": 0,
        "loss": {
            "type": "ce"
        },
        "max_batch_num_per_epoch": [
            400,
            3,
            3
        ],
        "method_name": "seg_unet",
        "model": "seg_net",
        "model_path": "/playpen-raid1/zyshen/data/brain_35/corrected/custom_seg/checkpoints/epoch_100_",
        "n_in_channel": 1,
        "optim": {
            "adam": {
                "beta": 0.9
            },
            "lr": 0.0005,
            "lr_scheduler": {
                "custom": {
                    "gamma": 0.1,
                    "step_size": 60
                },
                "type": "custom"
            },
            "optim_type": "adam"
        },
        "output_root_path": "",
        "output_taking_original_image_format": false,
        "print_step": [
            10,
            4,
            4
        ],
        "print_val_detail": true,
        "save_3d_img_on": true,
        "save_extra_3d_img": true,
        "save_fig_on": true,
        "seg": {
            "class_num": 24,
            "use_bn": true,
            "ensemble_during_the_test": true,

                "seg_ensemble": {
                "warped_pth": "/playpen-raid1/zyshen/data/brain_35/non_resize/data_aug_test/aug_k1",
                "warped_type": "*_image.nii.gz",
                "inv_phi_pth": "/playpen-raid1/zyshen/data/brain_35/non_resize/data_aug_test/aug_k1",
                "inv_switcher": ["_image.nii.gz","_inv_map.nii.gz"],
                "num_max": 20,
                "weight_for_orig_img": 0.2,
                "nomralize_type": "same_as_loader"

            }
        },
        "task_name": "",
        "train": true,
        "use_physical_coord": false,
        "val_period": 10,
        "warmming_up_epoch": 2
    }
}